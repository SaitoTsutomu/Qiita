title: 2つの封筒問題（封筒のパラドックス）
tags: 数学 確率 封筒の問題 パラドックス
url: https://qiita.com/SaitoTsutomu/items/3079a88163153abf2ac2
created_at: 2023-07-22 15:06:26+09:00
updated_at: 2024-08-25 16:47:37+09:00
body:

## はじめに

本記事では「2つの封筒問題」の主な3種類について、回答と簡潔な説明をする。
書籍やネット上の解説記事は、説明過多でわかりにくく間違いが多い。このような間違った情報が減少すれば幸いである。

※ **本記事へのコメントはしないでください。コメントがあった場合、すべて削除依頼します。**

## 問題

### 2つの封筒問題（未開封版）

> お金の入った2つの封筒があり、片方はもう片方の2倍の金額になっている。無作為に1つの封筒を選んだとき、交換した方が得か？

### 2つの封筒問題（金額仮定版）

> お金の入った2つの封筒があり、片方はもう片方の2倍の金額になっている。無作為に1つの封筒を選んだとき、交換した方が得か？ただし、**選んだ方の金額を2Yとする**（金額は仮定するだけで開封は不要）。

### 2つの封筒問題（分布と金額仮定版）

> お金の入った2つの封筒があり、片方はもう片方の2倍の金額になっている。無作為に1つの封筒を選んだとき、交換した方が得か？ただし、**次のように金額を決め、選んだ方の金額をZとする**（金額は仮定するだけで開封は不要）。
> 1または２が出るまでサイコロを振る。振った回数が$N$になったら1つの封筒に$2^N$の金額を、1つの封筒に$2^{N-1}$の金額を入れる。

## 回答

### 2つの封筒問題（未開封版）の回答

交換しても**変わらない**。

#### 説明

片方をX、もう片方を2Xとしたとき、無作為に選んだときの期待値は1.5Xである。別の封筒の期待値も1.5Xで変わらない。

### 2つの封筒問題（金額仮定版）の回答

交換した方が得かどうかは**不明**になる。

#### 説明

金額が2Yの場合、下記のどちらかである。この2つの割合がどうなっているかは、情報がないので不明である。

・Yと2Yが用意されていて、2Yを選んだ
・2Yと4Yが用意されていて、2Yを選んだ

※ この2つから無作為に選んでいるわけではないので、確率は半々ではない。

### 2つの封筒問題（分布と金額仮定版）の回答

交換した方が**得**である。

#### 説明

もう１つの数字が$\frac{Z}{2}$か$2Z$かの比は$3:2$であり、交換した場合の期待値は$\frac{11Z}{10}$である。

## 補足

未開封の場合は、直感と合致しているのでわかりやすい。

開封して金額を確認した場合は、金額仮定版と同じ回答になる。正解が存在する学校教育に慣れていると「交換したほうが得」と間違いやすい。

金額の分布を問題のように仮定し、さらに選んだ方の金額を仮定すると、交換した方が期待値は増える。なお、金額の分布を仮定しても選んだ方の金額を仮定しない場合は、交換しても変わらない。

## パラドックスか？に対する説明

2つの封筒問題（未開封版）において、片方をX、もう片方を2Xとする。無作為に選ぶので、下記のようになる。

* 確率1/2でXを選ぶ。交換すると2倍になる
* 確率1/2で2Xを選ぶ。交換すると1/2倍になる

上記から、**比率の期待値は1.25倍になる**。

このことから「`どちらを選んでも交換した方が得になるからパラドックスである`」という主張は間違いである。「`比率の期待値が1.25倍`」は正しい。間違いは「`交換した方が得`」というところである。分母が異なるものの比率の期待値が1を超えていても値として増えるわけではないからである。

| 正しい解釈 | X → 2X （確率1/2）<br>2X → X （確率1/2）|
|:--|:--|
| 間違った解釈 | X → 2X （確率1/2）<br>X → X/2 （確率1/2）|

※ 選んだ封筒の金額に、1.25を掛けるのは間違った解釈

別の例で説明する。
たとえば、西暦が偶数のときに`100`万円、奇数のときに`374`万円の給与になる会社があったとしよう。この会社の給与は2年づつ平均を見れば横ばいだが、比率の期待値は約`2`（`(374/100 + 100/374) / 2`）である。

## 「期待値が無限大だから交換しても変わらない」に対する説明

2つの封筒問題（未開封版）において、期待値が無限大だから交換しても変わらないという主張は誤りである。
まず、期待値が無限大だという前提が間違い。さらに、2つの金額を$(X, 2X)$と仮定するだけで答えはでる（$X$の分布は不要）。

## 「開封して必ず金額を確認するつもりなら、交換した方が得」に対する説明

2つの封筒問題（分布と金額仮定版）において、**まだ選択していない**状況で「選択後開封して**必ず金額を確認するつもり**なら、交換した方が得」は間違いである。
「選択後必ず開封する」だけ仮定しても、交換で変わらない。開封だけを仮定しただけでは、金額が前提でないからである。金額を仮定すると変わる。
2つの封筒問題（分布と金額仮定版）では、**選択していなくても**金額を仮定さえすれば、交換した方が得になる。
同様に、2つの封筒問題（金額仮定版）では、**選択していなくても**金額を仮定さえすれば、交換した方が得かどうかは不明になる。

## 「どちらを選んでも得なのはパラドックスか？」に対する説明

2つの封筒問題（分布と金額仮定版）で、以下は矛盾していない。
* 選んだ方の金額をZと仮定すると、交換した方が得
* 選ばない方の金額をZと仮定すると、交換した方が損
選ばない方の金額をZとしたとき、選んだ方はZ/2または2Zなので1つの数字を仮定していない。すなわち、1つの数字を仮定したときと別の仮定なので、異なる結果になっても矛盾しない。

## 参考

https://qiita.com/SaitoTsutomu/items/60b64b0de2c42ec8c1cb

https://qiita.com/SaitoTsutomu/items/63885dec1cca99acb7bb

https://qiita.com/SaitoTsutomu/items/9784e4451d6d510dbfbb#mag-%E3%81%8A%E9%A1%8C%E3%81%9D%E3%81%AE22%E3%81%A4%E3%81%AE%E5%B0%81%E7%AD%92%E3%81%AE%E5%95%8F%E9%A1%8C

