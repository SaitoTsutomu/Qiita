title: 封筒の問題（変形版）
tags: 数学 確率 封筒の問題 パラドックス
url: https://qiita.com/SaitoTsutomu/items/60b64b0de2c42ec8c1cb
created_at: 2021-12-26 19:24:33+09:00
updated_at: 2022-01-05 00:11:29+09:00
body:

## 確率の問題

1または２が出るまでサイコロを振る。振った回数が$N$になったら1つの封筒に$2^N$の数字を、1つの封筒に$2^{N-1}$の数字を書いて入れる。
なお、回数が$N$になる確率は、$\frac{1}{3}(\frac{2}{3})^{N-1}$である。

もし、無作為に封筒を１つ選び開封して数字は2であった場合、次のことが言える。回数が１の確率は$\frac{1}{3}$で、回数が2の確率は$\frac{2}{9}$であるから、もう1つの封筒の数字が1である確率は$\frac{3}{5}$で、数字が4である確率は$\frac{2}{5}$である。したがって、交換したときの期待値は2.2となり交換した方が数字が大きくなる。

上記のルールで用意した２つの未開封の封筒があり、無作為に１つの封筒を選んだ。このとき、以下について答えよ。

- **問1**：未開封の場合、交換しても期待値は変わらないか？
- **問2**：開封して数字を確認した場合、（その数字を前提として）交換すると期待値は増えるか？ただし、開封した数字は２以上とする。
- **問3**：未開封のまま中味について、１つの数字$x$と仮定する。このとき、交換すると期待値は増えるか？ただし、$x$は２以上とする。

## 解答

### 問１

答えはYes。

２つの数字を$2x$と$x$とする。無作為に選んでいるので各々を選ぶ確率は$\frac{1}{2}$である。したがって、交換した場合の差分の期待値は、$\frac{x}{2}-\frac{x}{2} = 0$である。

### 問２

答えはYes。

開封して確認した数字を$x$とする。
もう１つの数字が$\frac{x}{2}$か$2x$かの比は、$3:2$であり、交換した場合の差分の期待値は、$\frac{x}{10}$である。

### 問3

答えはYes。

たとえ未開封であっても、数字を１つ仮定した状況では、問２と同じ計算をすることができる。
開封したかどうかは関係なく、１つの数字を仮定したかどうかに意味がある。

## 考察

問１は数字を1つだけと仮定していない。問１と問３は同じ問いではないので、答えが違っても矛盾はない。

$N$ | そのときの確率 | 片方の数字 | もう片方の数字 |
| :-- | :-- | :-- | :-- |
１ | $\frac{1}{3}$ | 1 | 2 |
2 | $\frac{2}{9}$ | 2 | 4 |
3 | $\frac{4}{27}$ | 4 | 8 |
... | ... | ... | ... |
$n$ | $\frac{1}{3}(\frac{2}{3})^{n-1}$ | $2^{n-1}$ | $2^n$ |
$n + 1$ | $\frac{1}{3}(\frac{2}{3})^{n}$ | $2^{n}$ | $2^{n+1}$ |
... | ... | ... | ... |

まず、上記の表の各行で考えた場合、無作為に数字を選べば交換しても期待値は変わらない。どの行でも変わらないのだから行が無数にあっても変わらないと言える。

さて、開封した数字を$2^n$としよう。もう片方の数字が、$2^{n-1}$と$2^{n+1}$になるのは、$3 : 2$であるから、交換したときの期待値は0より大きい。

未開封の場合に、選んだ数字を$2^i$としよう。これを$i = 1 ... n$まで見れば、どの$i$についても期待値は交換した方が大きい。しかし、計算を省略した$i > n$についての分の期待値は、無視できない値となる。$i$をいくつまで計算しても、$i$を計算した範囲以外が無視できない誤差となって残る。したがって、任意の$i$で「交換した方がよい」と言えても、すべてを対象とするならば「交換してもしなくても同じ」と考えるべきである。

## 余談その１

問題を少し変えて、２人がそれぞれ封筒を受け取るとしよう。
１人が数字を仮定した状況は、問２（および問３）と同じである。
２人がそれぞれ数字を1つ仮定すると、どちらかが大きいかが決まることになる。したがって、交換するとどちらかが得をしどちらかが損をする。

## 余談その２

未開封の封筒が２つある状況を考える。このあと「無作為に封筒を１つ選んで開封して数字を確認し、その後封筒を交換する」つもりだとしよう。この場合、封筒を交換しても数字の期待値は変わらない。「任意の数字に対して交換する」ことが前提だからだ。
交換して期待値が増えるのは、「１つの数字を仮定する」という前提があって成り立つ。未開封の状態では、確認する数字は任意の可能性がある。その中の１つの数字の場合の可能性だけ取り出して期待値を求めれば、交換して期待値は増える。
最初の状況に対してこのことを言い直すと次のようになる。`無作為に封筒を１つ選び開封する。開封した数字をXとする。このとき、封筒を交換すると期待値は、Xより増える`[^1]。

[^1]: これが言えるのは、期待値を計算できるからだ。参考の「確率の問題 - お題その2（2つの封筒の問題）」は、「１つの数字を仮定」しても期待値は計算できないことに注意。

## 参考

- [確率の問題 - お題その2（2つの封筒の問題）](https://qiita.com/SaitoTsutomu/items/9784e4451d6d510dbfbb#mag-%E3%81%8A%E9%A1%8C%E3%81%9D%E3%81%AE22%E3%81%A4%E3%81%AE%E5%B0%81%E7%AD%92%E3%81%AE%E5%95%8F%E9%A1%8C)
- [2つの封筒問題のパラドックス](https://qiita.com/SaitoTsutomu/items/63885dec1cca99acb7bb)

以上

